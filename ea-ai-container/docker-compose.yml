services:
  ea-ai-agent:
    build: .
    container_name: ea-ai-agent
    restart: unless-stopped
    ports:
      - "8080:8080"
    environment:
      - NODE_ENV=production
      - PORT=8080
      - HUATA_URL=http://huata-calendar-agent:8003
      - LYCO_URL=http://lyco-telegram-bot:8000
      - REDIS_URL=redis://lyco-redis:6379
    volumes:
      - ./state:/app/state
      - ./logs:/app/logs
      - ./cache:/app/cache
    networks:
      - demestihas-network
    healthcheck:
      test: ["CMD", "node", "healthcheck.js"]
      interval: 30s
      timeout: 3s
      retries: 3
      start_period: 5s

networks:
  demestihas-network:
    external: true

volumes:
  redis-data:
